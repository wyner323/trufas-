<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Produ√ß√£o de Trufas üç´</title>
    <style>
        /* Estilos b√°sicos */
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 30px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1, h2 { color: #8B4513; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input[type="number"] { width: 90%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; }
        button { background-color: #A0522D; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px; font-size: 1em; }
        button:hover { background-color: #8B4513; }
        #resultados { margin-top: 30px; padding: 15px; border: 2px solid #A0522D; border-radius: 6px; }
        .lucro { color: green; font-weight: bold; font-size: 1.2em; }
        .unidade-custo { color: red; }
        
        /* Estilo para impress√£o (relat√≥rio) */
        @media print {
            button { display: none; } /* Esconde bot√µes no relat√≥rio impresso */
            body { border: none; box-shadow: none; max-width: 100%; }
        }
    </style>
</head>
<body>

    <h1>üç´ Calculadora de Trufas e Lucro</h1>
    <p>Insira os dados da sua produ√ß√£o para calcular custos, investimento e lucro.</p>
    
    <form id="calculadoraForm">
        <h2>Dados de Entrada</h2>
        
        <label for="qtd_produzida">Quantidade de Trufas Produzidas no Lote:</label>
        <input type="number" id="qtd_produzida" min="1" required>
        
        <label for="custo_unitario">Custo de Produ√ß√£o Unit√°rio (por trufa): R$</label>
        <input type="number" step="0.01" id="custo_unitario" required>
        
        <label for="preco_venda_unitario">Pre√ßo de Venda Unit√°rio (por trufa): R$</label>
        <input type="number" step="0.01" id="preco_venda_unitario" required>
        
        <button type="submit">üí∞ Calcular Resultados</button>
    </form>

    <div id="resultados">
        <h2>üìà Relat√≥rio Financeiro</h2>
        <p id="data_calculo"></p>
        </div>

    <button onclick="window.print()" id="btnImprimir" style="display: none;">üñ®Ô∏è Imprimir / Salvar PDF</button>

    <script>
        // Fun√ß√£o para formatar n√∫meros como moeda brasileira
        const formatarMoeda = (valor) => {
            const num = isNaN(valor) ? 0 : valor;
            return num.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        };

        // Fun√ß√£o principal de c√°lculo
        document.getElementById('calculadoraForm').addEventListener('submit', function(event) {
            event.preventDefault(); 

            // 1. Coleta e convers√£o dos dados
            const qtd_produzida = parseFloat(document.getElementById('qtd_produzida').value);
            const custo_unitario = parseFloat(document.getElementById('custo_unitario').value); 
            const preco_venda_unitario = parseFloat(document.getElementById('preco_venda_unitario').value);

            // Valida√ß√£o b√°sica
            if (qtd_produzida <= 0 || isNaN(qtd_produzida) || isNaN(custo_unitario) || isNaN(preco_venda_unitario)) {
                document.getElementById('resultados').innerHTML = '<h2>Relat√≥rio Financeiro</h2><p style="color: red;">Por favor, insira valores positivos e v√°lidos em todos os campos.</p>';
                document.getElementById('btnImprimir').style.display = 'none';
                return;
            }

            // 2. C√°lculos Essenciais 
            const custo_total_produtos = custo_unitario * qtd_produzida;
            const receita_total_estimada = preco_venda_unitario * qtd_produzida;
            const lucro_total = receita_total_estimada - custo_total_produtos;
            const lucro_unitario = preco_venda_unitario - custo_unitario;

            let margem_lucro_percentual = 0;
            if (receita_total_estimada > 0) {
                margem_lucro_percentual = (lucro_total / receita_total_estimada) * 100;
            }
            
            // 3. Montagem do Relat√≥rio HTML
            const resultadosDiv = document.getElementById('resultados');
            const data_calculo = document.getElementById('data_calculo');
            
            data_calculo.textContent = `C√°lculo realizado em: ${new Date().toLocaleString('pt-BR')}`;

            resultadosDiv.innerHTML = `
                <h2>üìà Relat√≥rio Financeiro</h2>
                <p id="data_calculo">C√°lculo realizado em: ${new Date().toLocaleString('pt-BR')}</p>

                <p><strong>Trufas Produzidas neste Lote:</strong> ${qtd_produzida}</p>
                <hr>
                
                <h3>Detalhes do Investimento</h3>
                <ul>
                    <li><strong>Custo Total (Investimento) do Lote:</strong> ${formatarMoeda(custo_total_produtos)}</li>
                    <li><strong>Pre√ßo de Venda Unit√°rio:</strong> ${formatarMoeda(preco_venda_unitario)}</li>
                    <li class="unidade-custo"><strong>Custo de Produ√ß√£o Unit√°rio:</strong> ${formatarMoeda(custo_unitario)}</li>
                </ul>
                
                <h3>Resultado Estimado (Venda Total)</h3>
                <ul>
                    <li>Receita Total Estimada: <strong>${formatarMoeda(receita_total_estimada)}</strong></li>
                    <li class="lucro">Lucro por Unidade: <strong>${formatarMoeda(lucro_unitario)}</strong></li>
                    <li class="lucro">LUCRO TOTAL Estimado: ${formatarMoeda(lucro_total)}</li>
                    <li>Margem de Lucro: ${margem_lucro_percentual.toFixed(2)}%</li>
                </ul>
                
                <p>Use este relat√≥rio para o controle de gastos, investimento e lucro.</p>
            `;
            
            document.getElementById('btnImprimir').style.display = 'block';
        });
    </script>

</body>
</html>